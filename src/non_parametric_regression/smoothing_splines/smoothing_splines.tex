\begin{defnbox}\nospacing
    \begin{defn}[Smoothing Splines Problem]\label{defn:smoothing_splines_problem}
        \begin{align}
          \widehat{m}(x)=\argmin_{m(x)}\sum_{\idxi=1}^{n}\left(Y_{i}-m(x_{\idxi})\right)^{2}+\lambdac\int m''(z)^{2}\diff z\label{eq:smoothing_spline_problem}
        \end{align}
    \end{defn}
\end{defnbox}
\begin{notebox}[Note]\nospacing
    We penalize this problem with the curvature $m''$:
    \begin{itemizenosep}
        \item $\lambdac=0$ we obtain interpolating natural cubic splines.
        \item $\lambdac=\infty$ we obtain the least squares linear regression fit i.e. $m''(x)\equiv0$.
    \end{itemizenosep}
    a large $\lambdac$ leads to a smooth function.
\end{notebox}
\begin{theorembox}\nospacing
    \begin{theorem}[Smoothing Spline Solution]\leavevmode\\
        The solution of \cref{eq:smoothing_spline_problem}, (over infinite-dimensional function space) is a finite dimensional
        p.w.\ cubic polynomial -- natural cubic spline\cref{defn:splines} and can be determined using least squares linear regression.
    \end{theorem}
\end{theorembox}
\begin{defnbox}\nospacing
    \begin{defn}[\hfill\coderef{defnc:smoothing_splines}\newline\blackrb{Natural} Splines]\label{defn:splines}\leavevmode\\
        \begin{minipage}[b]{0.58\textwidth}
            is a p.w.\ cubic polynomial\cref{defn:cubic_polynomials} of the form:
            \begin{align}
              \polynomial(x)=\sum_{i=1}^{\idxn}\betac_{i}\basis_{j}(x)
              \label{eq:splines}
            \end{align}
            defined on the intervals $[x_{i},x_{i+1})$ of a
            set of sorted and unique values $x_{1}<x_{2}<\ldots<x_{\idxn}$, associated to $\idxn$ observations $\left\{y_{i}\right\}_{i=1}^{\idxn}$.
        \end{minipage}\hfil
        \begin{minipage}[c]{0.4\textwidth}
        \centering{
          \resizebox{\linewidth}{!}{\input{src/non_parametric_regression/smoothing_splines/figures/tikz/splines.tex}}
        }
        \end{minipage}
        \begin{itemizenosep}
            \item for the $n-1$ intervals we need to determined $(n-1)\cdot 4$ coefficients.
            \item we have 3 continuity conditions for the $n-2$ inner nodes:
            \begin{align}
              &\forall\idxi=2,\ldots,n-2&&
              \begin{aligned}
                  &\polynomial(x_{\idxi})=\polynomial(x_{\idxi+1})\\
                  &\polynomial'(x_{\idxi})=\polynomial'(x_{\idxi+1})\\
                  &\polynomial''(x_{\idxi})=\polynomial''(x_{\idxi+1})
              \end{aligned}
            \end{align}
            \item 2 \textit{natural} conditions:
            \begin{align}
              \polynomial''(x_{1})=\polynomial''(x_{\idxn})=0
            \end{align}
        \end{itemizenosep}
        thus we have $4(n-1)-\left(3(n-2)+2\right)=n$ free parameters.
    \end{defn}
\end{defnbox}
\begin{corbox}\nospacing
    \begin{cor}[smoothing splines solution]\label{cor:smoothing_splines_solution}\leavevmode\\
        problem \cref{eq:smoothing_spline_problem} can be written as lsq. problem:
        \begin{align*}
          &\norm{\Yvec-\basis\betacvec}^{2}+\lambdac\betacvec^{\T}\omega\betacvec&&
          \begin{aligned}
              &\Omega_{\idxj\idxk}=\int\Basis_{\idxj}''(z)\Basis_{\idxk}''(z)\diff z \\[-1\jot]
              &\Basis_{:,\idxj}=\pmat{\Basis_{\idxj}(x_{1})&\Cdots&\Basis_{\idxj}(x_{n})}^{\T}
          \end{aligned}
        \end{align*}
        \begin{align}
          \widehat{\betacvec}=\left(\Basis^{\T}\Basis+\lambdac\Omega\right)^{-1}\Basis^{\T}\vec{Y}&&\widehat{\betacvec}\in\R^{n}
        \end{align}
    \end{cor}
\end{corbox}
\begin{defnbox}\nospacing
    \begin{defn}[Hat Matrix]\label{defn:hat_matrix}
        \begin{align}
          \widehat{\Yvec}=\pmat{\widehat{Y}_{1}&\Cdots&\widehat{Y}_{n}}^{\T}=\vec{S}_{\lambdac}\vec{Y}&&
          \vec{S}_{\lambdac}=\Basis\left(\Basis^{\T}\Basis+\lambdac\Omega\right)^{-1}\Basis^{\T}
        \end{align}
    \end{defn}
\end{defnbox}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../../formulary"
%%% TeX-command-extra-options: "-shell-escape"
%%% End:
